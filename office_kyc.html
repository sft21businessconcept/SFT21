<!DOCTYPE html>

<html lang="hr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Potvrdi Identitet (KYC) - SFT21</title>
<!-- ============================================= -->
<!-- UNIVERZALNA SKRIPTA ZA INICIJALIZACIJU TEME -->
<!-- Rješava "bljesak" i problem s back-forward cacheom -->
<!-- ============================================= -->
<script>
        // Funkcija za primjenu teme, da izbjegnemo ponavljanje koda
        function applySft21Theme() {
            try {
                // Ako tema nije postavljena, zadana je 'dark'
                const theme = localStorage.getItem('sft21_theme') || 'dark';

                if (theme === 'light') {
                    // Ako je tema 'light', DODAJ klasu
                    document.documentElement.classList.add('light-mode');
                } else {
                    // U svim ostalim slučajevima (ako je 'dark'), UKLONI klasu
                    document.documentElement.classList.remove('light-mode');
                }
            } catch (e) {
                console.error('Greška pri primjeni teme:', e);
            }
        }

        // 1. Primijeni temu ODMAH pri učitavanju da se spriječi "bljesak"
        applySft21Theme();

        // 2. Dodaj listener za 'pageshow' događaj. Ovo rješava problem
        //    kada se stranica učita iz "back-forward" cachea preglednika.
        window.addEventListener('pageshow', function(event) {
            // event.persisted je 'true' ako je stranica učitana iz cachea
            if (event.persisted) {
                console.log('Stranica učitana iz bfcachea, ponovno provjeravam temu.');
                applySft21Theme();
            }
        });
    </script>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&amp;family=Orbitron:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="css/style.css" rel="stylesheet"/>
<link href="css/vertical-putovnica-final.css" rel="stylesheet"/>
<style>
        /* DODANI STILOVI ZA ANIMACIJU POZADINE */
        #network-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Postavlja platno iza svog sadržaja */
        }
        
        .accordion-item.active .accordion-content { max-height: 150vh; padding-top: 0.5rem; padding-bottom: 1.5rem; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out; padding-top: 0; padding-bottom: 0; }
        .accordion-content > div, .accordion-content > p, .accordion-content > ul, .accordion-content > ol { padding-left: 1.5rem; padding-right: 1.5rem; color: #e5e7eb; line-height: 1.7; }
        .accordion-content p { margin-bottom: 1rem; }
        .accordion-content p:last-child { margin-bottom: 0; }
        .accordion-content ul, .accordion-content ol { margin-left: 1.5rem; margin-bottom: 1rem; list-style-position: outside; }
        .accordion-content ul li { margin-bottom: 0.5rem; list-style-type: disc; }
        .accordion-content strong, .accordion-content b { color: #f3e5f5; }
        .accordion-header i { transition: transform 0.3s ease-in-out; }
        .ip-card { background-color: rgba(106, 27, 154, 0.1); border-radius: 15px; overflow: hidden; display: flex; flex-direction: column; transition: transform 0.3s ease, box-shadow 0.3s ease; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); }
        .ip-card:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 10px 25px rgba(106, 27, 154, 0.4); }
        .ip-card-header { background: linear-gradient(to right, var(--fluorescent-green), var(--success-green)); padding: 1rem 1.5rem; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .ip-card-header h4 { color: white; font-family: 'Century Gothic', CenturyGothic, AppleGothic, sans-serif; font-size: 1.25rem; font-weight: 700; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); }
        .ip-card-body { padding: 1.5rem; text-align: center; color: #e5e7eb; font-size: 0.95rem; flex-grow: 1; line-height: 1.7; }
        .ip-card-body p { margin-bottom: 1rem; }
        .ip-card-body span.label { color: #d1d5db; }
        .ip-card-body span.value { font-weight: 700; color: #f3e5f5; }
        .ip-card-body span.duration { display: block; font-size: 0.8rem; color: #9ca3af; margin-top: -0.5rem; margin-bottom: 1rem; }
        .ip-card-footer { padding: 1.5rem; text-top: auto; }
        .info-box { background: rgba(106, 27, 154, 0.1); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); border-radius: 10px; padding: 1.5rem; display: flex; align-items: center; transition: all 0.3s ease; }
        .info-box:hover { background: rgba(106, 27, 154, 0.2); transform: scale(1.03); }
        .info-box-icon { flex-shrink: 0; margin-right: 1rem; font-size: 1.75rem; width: 40px; text-align: center; }
        .info-box-content h5 { font-family: 'Century Gothic', CenturyGothic, AppleGothic, sans-serif; font-weight: 600; color: white; margin-bottom: 0.25rem; font-size: 1.1rem; }
        .info-box-content p { font-size: 0.8rem; color: #d1d5db; line-height: 1.4; margin-bottom: 0; }
        .ip-wide-card { padding: 0 !important; max-width: calc(1200px + 3rem); margin-left: auto; margin-right: auto; box-sizing: border-box; }
        @media (max-width: 1280px) { .ip-wide-card { max-width: calc(960px + 3rem); } }
        @media (max-width: 1024px) { .ip-wide-card { max-width: calc(768px + 2rem); } }
        @media (max-width: 768px) { .ip-wide-card { max-width: 100%; } }
        .ip-wide-card.glass-card { border: 1px solid var(--fluorescent-green); border-radius: 15px; overflow: hidden; }
        .ip-wide-card-header { background: linear-gradient(to right, var(--fluorescent-green), var(--success-green)); padding: 1rem 1.5rem; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .ip-wide-card-header .ip-wide-card-header-title { color:#0e076a !important; font-family: 'Century Gothic', CenturyGothic, AppleGothic, sans-serif; font-size: 1.5rem; font-weight: 700; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); margin-bottom: 0; }
        .ip-wide-card .amount-input-container { display: none; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px dashed rgba(255, 255, 255, 0.1); text-align: center; }
        .ip-wide-card .amount-input-container label { display: block; margin-bottom: 0.5rem; color: #d1d5db; text-align: center; }
        .ip-wide-card .amount-input-wrapper { display: flex; justify-content: center; align-items: center; margin-bottom: 1rem; }
        .ip-wide-card .amount-input { width: 150px; padding: 10px 12px; border: 1px solid var(--fluorescent-green); border-radius: 8px; background-color: rgba(106, 27, 154, 0.1); color: white; text-align: center; margin-right: 0.5rem; -moz-appearance: textfield; }
        .ip-wide-card .amount-input::-webkit-outer-spin-button, .ip-wide-card .amount-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .ip-wide-card .amount-input:focus { outline: none; border-color: var(--fluorescent-green); box-shadow: 0 0 0 3px rgba(128, 255, 0, 0.2); }
        .ip-wide-card .amount-input::placeholder { color: rgba(255, 255, 255, 0.5); }
        .ip-wide-card .currency-symbol { color: white; font-size: 1rem; }
        .ip-wide-card .input-buttons { display: flex; justify-content: center; gap: 1rem; margin-top: 1rem; }
        .ip-wide-card .input-buttons .btn-primary { padding: 8px 16px; font-size: 0.9rem; }
        .ip-wide-card .input-buttons .btn-outline { background-color: transparent; color: #aaa; border: 1px solid #aaa; padding: 8px 16px; font-size: 0.9rem; border-radius: 50px; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease; }
        .ip-wide-card .input-buttons .btn-outline:hover { background-color: #aaa; color: #111; box-shadow: none; transform: none; }
        .popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); z-index: 9990; display: none; justify-content: center; align-items: center; }
        .popup-content { background: #0d0118; border: 1px solid var(--fluorescent-green); border-radius: 20px; padding: 2rem; max-width: 700px; width: 90%; text-align: center; position: relative; box-shadow: 0 8px 32px 0 rgba(128, 255, 0, 0.37); color: var(--text-color); }
        .popup-content h4 { color: var(--fluorescent-green) !important; margin-bottom: 1rem; }
        .popup-content p { margin-bottom: 1.5rem; line-height: 1.6; }
        .popup-content form { margin-top: 1.5rem; text-align: left; }
        .popup-content form .form-group { margin-bottom: 1rem; }
        .popup-content form label { display: block; margin-bottom: 0.5rem; color: #d1d5db; font-size: 0.9rem; }
        .popup-content form input { width: 100%; padding: 10px; border: 1px solid var(--fluorescent-green); border-radius: 5px; background-color: rgba(106, 27, 154, 0.1); color: white; }
        .popup-content form input:focus { outline: none; border-color: var(--fluorescent-green); box-shadow: 0 0 0 3px rgba(128, 255, 0, 0.2); }
        .popup-content form input::placeholder { color: rgba(255, 255, 255, 0.5); }
        .popup-close { position: absolute; top: 10px; right: 10px; font-size: 1.5rem; color: #aaa; cursor: pointer; transition: color 0.2s ease; background: none; border: none; padding: 0; }
        .popup-close:hover { color: white; }
        .ai-chat-float-icon { position: fixed; bottom: 2rem; right: 2rem; width: 60px; height: 60px; background-color: var(--primary-color); border-radius: 50%; border: 3px solid var(--fluorescent-green); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; cursor: pointer; z-index: 1000; opacity: 0.6; transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
        .ai-chat-float-icon:hover { opacity: 1; transform: scale(1.1); box-shadow: 0 8px 25px rgba(128, 255, 0, 0.4); }
        .ai-chat-popup { position: fixed; bottom: calc(2rem + 60px + 1rem); right: 2rem; width: 320px; height: 450px; background-color: #1f2937; border: 1px solid var(--fluorescent-green); border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4); z-index: 999; display: none; flex-direction: column; overflow: hidden; opacity: 0; transform: translateY(20px); transition: opacity 0.3s ease, transform 0.3s ease; }
        .ai-chat-popup.active { display: flex; opacity: 1; transform: translateY(0); }
        .ai-chat-popup-header { background: linear-gradient(to right, var(--primary-color), var(--secondary-color)); color: white; padding: 0.75rem 1rem; display: flex; justify-content: space-between; align-items: center; font-weight: 600; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .ai-chat-close-btn { background: none; border: none; color: white; font-size: 1.5rem; line-height: 1; cursor: pointer; opacity: 0.8; transition: opacity 0.2s ease; }
        .ai-chat-close-btn:hover { opacity: 1; }
        .ai-chat-popup-body { flex-grow: 1; padding: 1rem; overflow-y: auto; background-color: #111827; }
        .ai-chat-popup .ai-chat-input-container { background-color: #1f2937; padding: 0.75rem; border-top: 1px solid var(--fluorescent-green); }
        .ai-chat-popup .ai-chat-input { background-color: #374151; border-color: #4b5563; }
        .ai-chat-popup .ai-chat-input:focus { outline: none; border-color: var(--fluorescent-green); box-shadow: 0 0 0 1px rgba(128, 255, 0, 0.3); }
        .ai-chat-popup .ai-chat-button { font-size: 1.125rem; background: none; border: none; padding: 0.5rem; cursor: pointer; transition: color 0.2s ease; }
        .ai-chat-popup .ai-chat-button:hover { color: var(--fluorescent-green); }
        .user-counter-widget { position: fixed; top: 100px; right: 30px; width: 300px; background: rgba(13, 1, 24, 0.9); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border-radius: 15px; padding: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4); border: 1px solid var(--fluorescent-green); z-index: 990; cursor: grab; transition: transform 0.3s ease, opacity 0.3s ease, display 0s linear 0.3s; opacity: 1; user-select: none; }
        .user-counter-widget.dragging { cursor: grabbing; box-shadow: 0 10px 30px rgba(128, 255, 0, 0.3); opacity: 0.95; }
        .user-counter-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(128, 255, 0, 0.2); cursor: grab; }
        .user-counter-header h3 { margin: 0; font-size: 1.1rem; color: var(--fluorescent-green); display: flex; align-items: center; }
        .user-counter-actions button { background: none; border: none; color: rgba(255, 255, 255, 0.6); cursor: pointer; transition: color 0.3s ease; font-size: 18px; line-height: 1; padding: 0 5px; }
        .user-counter-actions button:hover { color: white; }
        .user-counter-body { cursor: default; }
        .user-counter-number { font-size: 1.8rem; font-weight: 700; text-align: center; margin-bottom: 15px; color: var(--fluorescent-green); text-shadow: 0 0 8px rgba(128, 255, 0, 0.5); }
        .user-counter-list { max-height: 180px; overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--secondary-color) rgba(128, 255, 0, 0.1); }
        .user-counter-list::-webkit-scrollbar { width: 5px; }
        .user-counter-list::-webkit-scrollbar-track { background: rgba(128, 255, 0, 0.1); border-radius: 10px; }
        .user-counter-list::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 10px; border: 1px solid rgba(128, 255, 0, 0.1); }
        .user-counter-item { display: flex; align-items: center; gap: 10px; padding: 6px 0; border-bottom: 1px solid rgba(128, 255, 0, 0.1); animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .user-counter-item:last-child { border-bottom: none; }
        .user-counter-flag { width: 24px; height: 16px; border-radius: 2px; object-fit: cover; border: 1px solid rgba(255,255,255,0.2); }
        .user-counter-name { flex: 1; font-size: 0.85rem; color: #e0e0e0; }
        .user-counter-time { font-size: 0.75rem; color: rgba(255, 255, 255, 0.5); }
        .user-counter-placeholder { text-align: center; color: rgba(255, 255, 255, 0.4); font-size: 0.9rem; padding: 20px 0; }
        .user-counter-show-btn { position: fixed; top: 85px; right: -45px; background: var(--primary-color); color: white; border: 2px solid var(--fluorescent-green); border-right: none; padding: 10px 10px 10px 15px; border-radius: 10px 0 0 10px; cursor: pointer; z-index: 989; transition: right 0.3s ease; font-size: 1.2rem; box-shadow: -5px 5px 10px rgba(0,0,0,0.3); }
        .user-counter-show-btn.visible { right: 0; display: flex; align-items: center; }
        .user-counter-show-btn:hover { background: var(--secondary-color); }
        .language-dropdown { display: none; position: absolute; background-color: #1f2937; border: 1px solid var(--fluorescent-green); border-radius: 0.375rem; margin-top: 0.5rem; padding: 0.25rem 0; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); right: 0; z-index: 60; min-width: 80px; }
        .language-dropdown.active { display: block; }
        .language-item { display: flex; align-items: center; padding: 0.5rem 0.75rem; font-size: 0.875rem; color: #d1d5db; white-space: nowrap; cursor: pointer; }
        .language-item:hover { background-color: var(--primary-color); color: white; }
        .language-item .flag-image, .language-item .flag-icon { width: 20px; height: auto; margin-right: 0.5rem; flex-shrink: 0; }
        .language-item span:not(.flag-icon) { font-weight: 500; }
        .language-dropdown-mobile { display: none; background-color: #111827; border-radius: 0.375rem; margin-top: 0.5rem; padding: 0.25rem 0; width: 100%; }
        .language-dropdown-mobile.active { display: block; }
        .language-dropdown-mobile .language-item { justify-content: center; padding: 0.5rem 1rem; }
        .language-dropdown-mobile .language-item:hover { background-color: var(--primary-color); }
        .dropdown-menu:not(.language-dropdown):not(.language-dropdown-mobile) { position: absolute; display: none; }
        .group:hover .dropdown-menu:not(.language-dropdown):not(.language-dropdown-mobile) { display: block; }
        .nav-menu .dropdown-menu:not(.language-dropdown-mobile) { display: none; }

        .form-label { color: var(--text-color); margin-bottom: 0.5rem; display: block; font-size: 0.9rem; }
        .form-input-register { width: 100%; padding: 10px 12px; background-color: rgba(13, 1, 24, 0.5); border: 1px solid var(--fluorescent-green); border-radius: 8px; color: white; transition: all 0.3s ease; }
        .form-input-register:focus { outline: none; border-color: var(--fluorescent-green); box-shadow: 0 0 0 3px rgba(128, 255, 0, 0.3); background-color: rgba(13, 1, 24, 0.7); }
        .form-input-register::placeholder { color: rgba(255, 255, 255, 0.4); }
        .form-select { appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2380ff00' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3csvg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; }
        .form-radio-custom { appearance: none; width: 1.25em; height: 1.25em; border: 2px solid var(--fluorescent-green); border-radius: 50%; display: inline-blockclouds://clouds://; position: relative; margin-right: 0.5rem; cursor: pointer; vertical-align: middle; transition: background-color 0.2s ease; }
        .form-radio-custom:checked { background-color: var(--fluorescent-green); border-color: var(--fluorescent-green); }
        .form-radio-custom:checked::after { content: ''; display: block; width: 0.5em; height: 0.5em; background-color: #0d0118; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .radio-label { color: var(--text-color); vertical-align: middle; cursor: pointer; }
        .form-checkbox-custom { appearance: none; width: 1.25em; height: 1.25em; border: 2px solid var(--fluorescent-green); border-radius: 4px; display: inline-block; position: relative; margin-right: 0.5rem; cursor: pointer; vertical-align: middle; transition: background-color 0.2s ease; }
        .form-checkbox-custom:checked { background-color: var(--fluorescent-green); border-color: var(--fluorescent-green); background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='%230d0118' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3csvg%3e"); background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }
        .checkbox-label { color: var(--text-color); vertical-align: middle; cursor: pointer; font-size: 0.8rem; line-height: 1.4; }
        .checkbox-label a { color: var(--fluorescent-green); text-decoration: underline; }
        .social-login-button { display: flex; align-items: center; justify-content: center; padding: 10px; border: 1px solid var(--fluorescent-green); border-radius: 8px; color: var(--text-color); background-color: transparent; transition: background-color 0.3s ease; text-align: center; font-size: 0.9rem; }
        .social-login-button:hover { background-color: rgba(128, 255, 0, 0.1); }
        .social-login-button i { margin-right: 0.75rem; font-size: 1.2rem; color: var(--fluorescent-green); }
        .info-card-register { background: rgba(13, 1, 24, 0.4); border: 1px solid var(--fluorescent-green); border-radius: 15px; padding: 1.5rem; color: var(--text-color); height: 100%; }
        .info-card-register img { border-radius: 8px; margin-bottom: 1rem; }
        .info-card-register h3 { color: var(--fluorescent-green); margin-bottom: 1rem; font-size: 1.2rem; font-weight: 600; }
        .info-card-register ul li { display: flex; align-items: center; margin-bottom: 0.5rem; font-size: 0.9rem; }
        .info-card-register ul li i { color: var(--success-green); margin-right: 0.5rem; font-size: 0.8rem; }
        .date-input-group { display: flex; gap: 0.5rem; }
        .date-input-group select { flex: 1; }
        .change-sponsor-link { color: var(--fluorescent-green); text-decoration: none; font-size: 0.8rem; transition: text-decoration 0.2s ease; cursor: pointer; display: inline-block; vertical-align: baseline; margin-left: 0.5rem; line-height: 1; padding-bottom: 0; }
        .change-sponsor-link:hover { text-decoration: underline; }
        #registration-confirm-popup .popup-content {
            max-width: 550px;
            background: #111827;
            border: 1px solid var(--fluorescent-green);
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(128, 255, 0, 0.3);
            color: #D1D5DB;
        }
        #registration-confirm-popup h4 {
            color: var(--fluorescent-green) !important;
            font-size: 1.35rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        #registration-confirm-popup p {
            color: #D1D5DB;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        #registration-confirm-popup p strong {
            color: white;
            font-weight: 600;
        }
        #registration-confirm-popup .btn-register-confirm {
            margin-top: 1.5rem;
            background-color: var(--fluorescent-green) !important;
            color: #0e076a;
            padding: 12px 35px;
            border-radius: 8px;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
            border: none;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        #registration-confirm-popup .btn-register-confirm:hover {
            background-color: color-mix(in srgb, var(--fluorescent-green) 85%, black 15%);
            box-shadow: 0 6px 15px rgba(128, 255, 0, 0.4);
            transform: translateY(-2px);
        }
        #registration-confirm-popup .footer-link {
            color: #6B7280;
            font-size: 0.8rem;
            text-decoration: underline;
            margin-top: 1.5rem;
            display: block;
            transition: color 0.2s ease;
        }
        #registration-confirm-popup .footer-link:hover {
            color: #9CA3AF;
        }
        .kyc-container {
            background: rgba(13, 1, 24, 0.6);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid var(--fluorescent-green);
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            color: var(--text-color);
        }
        .kyc-title {
            color: var(--fluorescent-orange);
            font-weight: 700;
            font-size: 1.75rem;
            margin-bottom: 1rem;
            letter-spacing: 0.5px;
        }
        .kyc-icon-container {
            margin-bottom: 0.5rem;
        }
        .kyc-icon {
            font-size: 4rem;
            color: var(--fluorescent-orange);
        }
        .kyc-letters {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.25rem;
            font-weight: bold;
            color: var(--fluorescent-orange);
            text-align: center;
            letter-spacing: 5px;
            margin-bottom: 2rem;
        }
        .kyc-text-block {
            text-align: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }
        .kyc-highlight-white {
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            background-color: rgba(255, 255, 255, 0.05);
            padding: 0.5rem 1rem;
            border-radius: 5px;
            display: inline-block;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .kyc-highlight-yellow {
            color: var(--fluorescent-orange);
            font-weight: 600;
        }
        .kyc-list {
            list-style: none;
            padding-left: 0;
            margin-top: 0.5rem;
            margin-bottom: 1rem;
            text-align: left;
            display: inline-block;
        }
        .kyc-list.centered-list {
            text-align: center;
            display: block;
            width: auto;
            margin-left: auto;
            margin-right: auto;
        }
        .kyc-list li {
            position: relative;
            padding-left: 1.2rem;
            margin-bottom: 0.3rem;
        }
        .kyc-list li::before {
            content: "- ";
            color: var(--fluorescent-orange);
            position: absolute;
            left: 0;
            top: 0;
            font-weight: bold;
        }
        .kyc-list.centered-list li {
            padding-left: 0;
            display: inline-block;
            text-align: left;
            margin-left: 0.5rem;
            margin-right: 0.5rem;
        }
        .kyc-list.centered-list li::before {
            content: "";
        }
        .kyc-document-section {
            margin-top: 2.5rem;
            padding-top: 1.5rem;
            border-top: 1px dashed rgba(128, 255, 0, 0.2);
        }
        .kyc-document-images {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            gap: 1.5rem;
            margin-top: 1rem;
            margin-bottom: 2.5rem;
        }
        .kyc-base-placeholder {
            background-color: rgba(255, 255, 255, 0.08);
            border: 1px dashed var(--fluorescent-green);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #a0aec0;
            text-align: center;
            padding: 0.75rem;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background  background-repeat: no-repeat;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .kyc-base-placeholder.kyc-placeholder-clickable {
            cursor: pointer;
        }
        .kyc-base-placeholder.kyc-placeholder-clickable:hover {
            background-color: rgba(128, 255, 0, 0.05);
            box-shadow: 0 0 15px rgba(128, 255, 0, 0.3);
        }
        .kyc-base-placeholder:not(.has-preview) .placeholder-prompt-text,
        .kyc-base-placeholder:not(.has-preview) .fa-camera-retro,
        .kyc-base-placeholder:not(.has-preview) .kyc-custom-icon,
        .kyc-base-placeholder:not(.has-preview) .placeholder-main-text,
        .kyc-base-placeholder:not(.has-preview) .placeholder-upload-text {
            opacity: 1;
            pointer-events: auto;
            transition: opacity 0.3s ease;
        }
        .kyc-base-placeholder.has-preview .placeholder-prompt-text,
        .kyc-base-placeholder.has-preview .fa-camera-retro,
        .kyc-base-placeholder.has-preview .kyc-custom-icon,
        .kyc-base-placeholder.has-preview .placeholder-main-text,
        .kyc-base-placeholder.has-preview .placeholder-upload-text {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .kyc-base-placeholder .placeholder-prompt-text {
            display: block;
            font-size: 0.7rem;
            color: #718096;
            z-index: 1;
            line-height: 1.2;
        }
        .kyc-base-placeholder .placeholder-upload-text {
            display: block;
            font-size: 0.7rem;
            color: #718096;
            z-index: 1;
            line-height: 1.2;
            text-decoration: underline;
            cursor: pointer;
            transition: color 0.2s ease;
            margin-top: 0.5rem;
        }
        .kyc-base-placeholder .placeholder-upload-text:hover {
            color: var(--fluorescent-green);
        }
        .kyc-base-placeholder .placeholder-main-text {
            display: block;
            font-size: 0.9rem;
            color: white;
            font-weight: 600;
            z-index: 1;
            line-height: 1.2;
        }
        .kyc-base-placeholder i.fa-camera-retro,
        .kyc-base-placeholder .kyc-custom-icon {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--fluorescent-green);
            cursor: pointer;
            transition: color 0.2s ease;
            position: relative;
            z-index: 5;
        }
        .kyc-base-placeholder i.fa-camera-retro {
            font-size: 1.5rem;
        }
        .kyc-base-placeholder .kyc-custom-icon {
            width: 48px;
            height: auto;
        }
        .kyc-base-placeholder i.fa-camera-retro:hover,
        .kyc-base-placeholder .kyc-custom-icon:hover {
            color: color-mix(in srgb, var(--fluorescent-green) 80%, white 20%);
        }
        .kyc-base-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.75rem;
        }
        .kyc-base-placeholder:not(#passport-placeholder):not(#driver-license-placeholder):not(#selfie-placeholder):not(#id-card-placeholder) {
            justify-content: center;
        }
        .kyc-document-placeholder-horizontal {
            width: 180px;
            height: 110px;
        }
        .kyc-document-placeholder-vertical {
            width: 150px;
            height: 180px;
        }
        .kyc-camera-placeholder {
        }
        #selfie-placeholder {
            margin: 1rem auto 2.5rem auto;
            justify-content: center;
        }
        #selfie-placeholder .placeholder-main-text {
            margin-bottom: 1.1rem;
        }
        #selfie-placeholder i.fa-camera-retro {
            font-size: 3rem;
            margin-top: 0;
            margin-bottom: 0.8rem;
        }
        #selfie-placeholder .placeholder-upload-text {
            margin-top: 0.4;
            font-size: 0.9rem;
            color: var(--fluorescent-green);
        }
        .btn-kyc-continue {
            display: inline-block;
            background-color: var(--fluorescent-green) !important;
            color: #0e076a !important;
            padding: 12px 40px;
            border-radius: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: none;
            box-shadow: 0 4px 10px rgba(128, 255, 0, 0.3);
            transition: all 0.3s ease;
            margin-top: 2rem;
            cursor: pointer;
        }
        .btn-kyc-continue:hover {
            background-color: color-mix(in srgb, var(--fluorescent-green) 85%, black 15%) !important;
            color: #0e076a !important;
            box-shadow: 0 6px 15px rgba(128, 255, 0, 0.5);
            transform: translateY(-2px);
        }
        #camera-modal .popup-content {
            max-width: 640px;
            padding: 1rem;
            text-align: center;
            background: #111827;
        }
        #camera-feed-container {
            position: relative;
            width: 100%;
            max-width: 250px !important;
            margin-left: auto;
            margin-right: auto;
            aspect-ratio: 3 / 4;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--fluorescent-green);
            margin-bottom: 1rem;
            transition: aspect-ratio 0.3s ease, max-width 0.3s ease;
        }
        #camera-feed-container.is-horizontal {
            aspect-ratio: 4 / 3;
            max-width: 450px !important;
            transform: none !important;
        }
        #camera-feed {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: 0;
            border: none;
        }
        #camera-overlay {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            transition: border-radius 0.3s ease, width 0.3s ease, height 0.3s ease, top 0.3s ease;
        }
        .camera-overlay-oval {
            border-radius: 50%;
            width: 70%;
            height: 90% !important;
            border: 3px dashed rgba(255, 255, 255, 0.7) !important;
            top: 50% !important;
            transform: translate(-50%, -50%) !important;
        }
        .camera-overlay-rectangle-vertical {
            border-radius: 8px;
            width: 85% !important;
            height: 80% !important;
            border: 3px dashed rgba(255, 255, 255, 0.7) !important;
            top: 10% !important;
            transform: translateX(-50%) !important;
        }
        #camera-overlay.camera-overlay-rectangle-horizontal {
            border-radius: 8px !important;
            width: 85% !important;
            height: 70% !important;
            border: 3px dashed rgba(255, 255, 255, 0.7) !important;
            display: block !important;
            top: 15% !important;
            transform: translateX(-50%) !important;
        }
        #capture-btn {
            display: inline-block;
            padding: 10px 30px;
            background-color: var(--fluorescent-green);
            color: #0e076a;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }
        #capture-btn:hover {
            background-color: color-mix(in srgb, var(--fluorescent-green) 85%, black 15%);
            box-shadow: 0 6px 15px rgba(128, 255, 0, 0.4);
            transform: translateY(-2px);
        }
        #snapshot-canvas {
            display: none;
        }
        #id-card-placeholder .fa-camera-retro {
            font-size: 3rem;
            color: var(--fluorescent-green);
            margin-top: auto;
            margin-bottom: auto;
        }
        #id-card-placeholder .placeholder-main-text {
            margin-top: 0rem;
            margin-bottom: auto;
            font-weight: 600;
        }
        #id-card-placeholder .placeholder-upload-text {
            color: var(--fluorescent-green);
            font-size: 0.9rem;
            margin-top: 0;
            margin-bottom: 0.5rem;
        }
        #passport-placeholder .placeholder-main-text {
            margin-top: 0.5rem;
            margin-bottom: auto;
            cursor: pointer;
            color: white;
            font-size: 1rem;
            font-weight: 600;
        }
        #passport-placeholder i.fa-camera-retro {
            font-size: 3rem;
            color: var(--fluorescent-green);
            margin-top: auto;
            margin-bottom: auto;
        }
        #passport-placeholder .placeholder-upload-text {
            font-size: 0.9rem;
            color: var(--fluorescent-green);
            cursor: pointer;
            margin-top: auto;
            margin-bottom: 0.5rem;
        }
        #driver-license-placeholder .placeholder-main-text {
            margin-top: 0.5rem;
            margin-bottom: auto;
            font-weight: 600;
        }
        #driver-license-placeholder .fa-camera-retro {
            font-size: 3rem;
            color: var(--fluorescent-green);
            margin-top: auto;
            margin-bottom: auto;
        }
        #driver-license-placeholder .kyc-custom-icon {
            display: none;
        }
        #driver-license-placeholder .placeholder-upload-text {
            color: var(--fluorescent-green);
            font-size: 0.9rem;
            margin-top: auto;
            margin-bottom: 0.5rem;
        }
        /* Stil za okvir Review Popup-a */
#review-popup-content {
    border: 1px solid #9c27b0; /* Fluorescentno ljubičasta boja - možete zameniti sa var(--secondary-color) ako ste sigurni da ta varijabla postoji i da je ljubičasta */
    /* Ako želite i ljubičastu senku, dodajte: */
    /* box-shadow: 0 0 20px rgba(156, 39, 176, 0.5); */
}
    </style>
<!-- NOVI STILOVI ZA LIGHT MODE -->
<style>
        html.light-mode body {
            background-color: #f8fafc !important;
            color: #334155 !important;
        }
        html.light-mode #network-canvas {
            background-color: transparent !important;
        }
        html.light-mode .kyc-container,
        html.light-mode .popup-content,
        html.light-mode #review-popup-content {
            background-color: #ffffff !important;
            border-color: var(--primary-color) !important; 
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05) !important;
        }
        html.light-mode .kyc-title,
        html.light-mode .kyc-icon,
        html.light-mode .kyc-letters,
        html.light-mode .kyc-highlight-yellow,
        html.light-mode .kyc-list li::before {
            color: var(--primary-color) !important;
        }
        html.light-mode .text-gray-300,
        html.light-mode .kyc-text-block p {
            color: #475569 !important;
        }
        html.light-mode .kyc-highlight-white {
            background-color: #f1f5f9 !important;
            color: var(--primary-color) !important;
        }
        html.light-mode .kyc-base-placeholder {
            background-color: #f8fafc !important;
            border-color: #cbd5e1 !important;
        }
        html.light-mode .placeholder-main-text,
        html.light-mode .placeholder-upload-text,
        html.light-mode .placeholder-prompt-text,
        html.light-mode #business-proof-note strong {
            color: #475569 !important;
        }
        html.light-mode .kyc-base-placeholder i {
            color: var(--primary-color) !important;
        }
        html.light-mode .btn-kyc-continue,
        html.light-mode #review-popup-nastavi,
        html.light-mode #capture-btn {
            background-color: var(--primary-color) !important;
            color: white !important;
        }
        html.light-mode .btn-kyc-continue:hover,
        html.light-mode #review-popup-nastavi:hover,
        html.light-mode #capture-btn:hover {
            background-color: var(--secondary-color) !important;
        }
        html.light-mode #review-popup-content h2,
        html.light-mode #review-popup-content h3 {
             color: var(--primary-color) !important;
        }
    </style>
</head>
<body class="bg-gray-900">
<!-- Platno za animaciju pozadine -->
<canvas id="network-canvas"></canvas>
<div class="custom-cursor"></div>
<div class="popup-overlay" id="popup-overlay">
<div class="popup-content" id="validation-popup" style="display: none;"></div>
<div class="popup-content" id="contact-form-popup" style="display: none;"></div>
<div class="popup-content" id="registration-confirm-popup" style="display: none;"></div>
<div class="popup-content" id="camera-modal" style="display: none;">
<button aria-label="Zatvori kameru" class="popup-close">×</button>
<h4 class="text-white text-center text-lg mb-3">Pozicionirajte <span id="camera-prompt-text">glavu unutar ovala</span></h4>
<div class="camera-feed-container" id="camera-feed-container">
<video autoplay="" id="camera-feed" playsinline=""></video>
<div class="camera-overlay-oval" id="camera-overlay"></div>
</div>
<canvas class="hidden" id="snapshot-canvas"></canvas>
<div class="text-center">
<button class="btn-primary" id="capture-btn" title="Snimi fotografiju">USLIKAJ</button>
</div>
</div>
</div>
<nav class="fixed top-0 left-0 w-full z-50"></nav>
<main class="pt-1 pb-1">
<div class="container mx-auto px-4">
<input accept="image/png, image/jpeg, image/jpg, application/pdf" id="doc-upload-input" style="display: none;" type="file"/>
<input accept="image/png, image/jpeg, image/jpg" capture="user" id="selfie-upload-input" style="display: none;" type="file"/>
<div class="kyc-container max-w-4xl mx-auto p-8 md:p-12 text-center">
<h2 class="kyc-title text-3xl md:text-4xl">Potvrdi svoj identitet</h2>
<div class="kyc-icon-container"> <i class="fas fa-shield-alt kyc-icon"></i> </div>
<div class="kyc-letters">K Y C</div>
<div class="kyc-text-block space-y-6">
<p class="text-gray-300 text-lg"> KYC je akronim (skraćenica) naziva "Know Your Customer" što u prijevodu sa engleskog znači "Poznajem svoga klijenta". </p>
<p class="kyc-highlight-white text-lg px-4"> KYC STANDARD PREDSTAVLJA PROCES U KOJEM SU KLIJENTI OBAVEZNI POTVRDITI SVOJ IDENTITET U SVRHU NASTAVKA LEGALNOG KORIŠTENJA STRANICA NAŠEG PORTALA, KAKO BI SE SPRIJEČILO LAŽNO ILI VIŠESTRUKO REGISTRIRANJE, PRANJE NOVCA, KRAĐA IDENTITETA, FINANCIJSKE PREVARE, FINANCIRANJE TERORIZMA I SL. </p>
</div>
<div class="kyc-document-section">
<p class="text-gray-300 text-lg mb-2"> <span class="kyc-highlight-yellow">Molimo priložite tražene dokumente za KYC provjeru:</span> </p>
<ul class="kyc-list text-gray-300 text-lg mb-4">
<li>JEDAN od identifikacijskih dokumenata: <strong>osobna iskaznica</strong>, ili <strong>putovnica</strong> ili <strong>vozačka dozvola</strong>.</li>
<li>Vaša <strong>vlastita fotografija</strong> (selfie - glava do ramena).</li>
</ul>
<div class="kyc-document-images">
<div class="kyc-base-placeholder kyc-document-placeholder-horizontal kyc-placeholder-clickable kyc-camera-placeholder" data-input="doc-upload-input" id="id-card-placeholder">
<span class="placeholder-main-text text-gray-400 text-sm">OSOBNA ISKAZNICA</span>
<i class="fas fa-camera-retro text-gray-500 mb-3"></i>
<span class="placeholder-upload-text text-gray-400 text-sm underline cursor-pointer">Učitaj dokument</span>
</div>
<div class="kyc-base-placeholder kyc-document-placeholder-vertical kyc-camera-placeholder kyc-placeholder-clickable" data-input="doc-upload-input" id="passport-placeholder">
<span class="placeholder-main-text text-gray-400 text-sm">PUTOVNICA</span>
<i class="fas fa-camera-retro text-gray-500 mb-3"></i>
<span class="placeholder-upload-text text-gray-400 text-sm underline cursor-pointer">Učitaj dokument</span>
</div>
<div class="kyc-base-placeholder kyc-document-placeholder-horizontal kyc-camera-placeholder kyc-placeholder-clickable" data-input="doc-upload-input" id="driver-license-placeholder">
<span class="placeholder-main-text text-gray-400 text-sm">VOZAČKA DOZVOLA</span>
<i class="fas fa-camera-retro mb-2"></i>
<span class="placeholder-upload-text text-gray-400 text-sm underline cursor-pointer">Učitaj dokument</span>
</div>
</div>
<div class="flex flex-col justify-center items-center gap-8 mt-4 mb-10" id="lower-kyc-fields-container">
<!-- SELFIE POLJE -->
<div class="kyc-base-placeholder kyc-document-placeholder-vertical kyc-camera-placeholder kyc-placeholder-clickable" data-input="selfie-upload-input" id="selfie-placeholder">
<span class="placeholder-main-text text-gray-400 text-sm">USLIKAJ SE</span>
<i class="fas fa-camera-retro text-gray-500 mb-2"></i>
<span class="placeholder-upload-text text-gray-400 text-sm underline cursor-pointer">Učitaj fotografiju</span>
</div>
<!-- POSLOVNO POLJE (inicijalno skriveno) -->
<div class="hidden flex-col items-center" id="business-proof-wrapper">
<div class="kyc-base-placeholder kyc-document-placeholder-vertical kyc-placeholder-clickable" data-input="doc-upload-input" id="business-proof-placeholder">
<span class="placeholder-main-text text-gray-400 text-sm">DOKAZ O REGISTRACIJI</span>
<i class="fas fa-file-alt text-gray-500 mb-2" style="font-size: 3rem;"></i>
<!-- IZMJENA 1: Promijenjena boja i veličina fonta linka -->
<span class="placeholder-upload-text text-fluorescent-green text-sm underline cursor-pointer" style="color: var(--fluorescent-green); font-size: 0.9rem;">Učitaj dokument</span>
</div>
<!-- IZMJENA 2 i 3: Tekst napomene je razdvojen u dva retka -->
<p class="text-gray-400 text-xs mt-2 text-center max-w-xs" id="business-proof-note">
<strong>Napomena:</strong><br/>
        Učitaj PDF kopiju originalnog rješenja o registraciji pravne osobe ili poslovnog subjekta.
    </p>
</div>
</div>
<!-- === KRAJ NOVOG KONTEJNERA === -->
<a class="btn-kyc-continue" href="#" id="kyc-continue-btn">POTVRDI UNOS </a>
</div>
<p class="text-gray-400 text-base mb-6 max-w-xl mx-auto mt-8">
                    Unos navedenih dokumenata potreban je isključivo u svrhu provjere identiteta korisnika te se u druge svrhe ne može koristiti 
                </p>
</div>
</div>
</main>

<div class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm z-[9990] flex items-center justify-center" id="validation-popup-overlay" style="display: none;">
<div class="popup-content" id="validation-popup">
<button aria-label="Zatvori" class="popup-close">×</button>
<h4 class="text-white text-center text-lg mb-3">Greška Validacije</h4>
<p class="text-gray-300 text-center mb-4" id="validation-popup-message"></p>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-70 z-[10000] flex items-center justify-center hidden" id="review-popup-overlay">
<div class="glass-card p-8 text-center w-full max-w-md mx-4" id="review-popup-content">
<h3 class="text-4xl font-semibold mb-4" style="color: var(--secondary-color); font-family: 'Century Gothic', CenturyGothic, AppleGothic, sans-serif !important;">♣ K Y C ♣</h3>
<h2 class="text-2xl font-bold mb-6" style="color: var(--secondary-color); font-family: 'Century Gothic', CenturyGothic, AppleGothic, sans-serif !important;"><strong>Vaši su dokumenti na pregledu</strong></h2>
<p class="text-gray-300 mb-4 leading-relaxed">
<strong>Po izvršenoj provjeri vaš će račun biti verificiran nakon čega možete nastaviti sa korištenjem dostupnih stranica našeg portala ili će vam verifikacija biti odbijena uz obrazloženje.</strong>
</p>
<p class="text-gray-300 mb-8 leading-relaxed">
<strong>U slučaju utvrđenih nepravilnosti (istekao osobni dokument, nepodudaranje podataka, loša kvaliteta fotografije osobnog dokumenta ili vlastite fotografije) biti ćete obaviješteni da ponovite radnju odnosno da unesete novu fotografiju.</strong>
</p>
<button class="btn-purple w-full py-3 px-6 rounded-full font-semibold uppercase tracking-wider transition-transform duration-300 transform hover:-translate-y-1" id="review-popup-nastavi" style="background-color: #6a1b9a; color: white; border: none;" type="button">NASTAVI</button>
</div>
</div>
<div class="fixed inset-0 bg-black bg-opacity-70 z-[9999] flex items-center justify-center hidden" id="validation-popup-overlay">
<div class="glass-card p-8 text-center w-full max-w-sm mx-4" id="validation-popup-content">
<h3 class="text-xl font-bold mb-4 text-fluorescent-green" style="font-family: 'Orbitron', sans-serif;">Greška pri unosu</h3>
<p class="text-gray-300 mb-6">Molimo popunite sva obavezna polja ispravnim podacima.</p>
<button class="btn-primary rounded-full font-semibold py-2 px-6 uppercase tracking-wide transition-transform duration-300 transform hover:-translate-y-1" id="validation-popup-ok" type="button">U redu</button>
</div>
</div>

    <!-- ======================================================= -->
    <!--      KONAČNI I ISPRAVLJENI SCRIPT BLOK ZA OFFICE_KYC.HTML     -->
    <!-- ======================================================= -->

    <!-- GSAP biblioteka, potrebna za animaciju kursora -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // === DEKLARACIJA ELEMENATA ===
        const body = document.body;
        const cursor = document.querySelector('.custom-cursor');
        const canvas = document.getElementById('network-canvas');
        const urlParams = new URLSearchParams(window.location.search);
        const source = urlParams.get('source');
        const guardianId = urlParams.get('guardian');
        const isGuardianKyc = source === 'guardian_kyc' && guardianId;
        const kycContinueBtn = document.getElementById('kyc-continue-btn');
        const reviewPopup = document.getElementById('review-popup-overlay');
        const reviewPopupNastaviBtn = document.getElementById('review-popup-nastavi');
        const businessWrapper = document.getElementById('business-proof-wrapper');
        const accountType = localStorage.getItem('sft21_account_type');
        const cameraModal = document.getElementById('camera-modal');
        const cameraFeed = document.getElementById('camera-feed');
        const captureBtn = document.getElementById('capture-btn');
        const snapshotCanvas = document.getElementById('snapshot-canvas');
        const popupOverlay = document.getElementById('popup-overlay');
        const cameraPromptText = document.getElementById('camera-prompt-text');
        const cameraOverlay = document.getElementById('camera-overlay');
        const cameraFeedContainer = document.getElementById('camera-feed-container');
        const clickablePlaceholders = document.querySelectorAll('.kyc-placeholder-clickable');
        const docUploadInput = document.getElementById('doc-upload-input');
        const selfieUploadInput = document.getElementById('selfie-upload-input');
        
        let currentStream = null;
        let isCameraOpening = false;

        // === LOGIKA ZA KURSOR ===
        if (cursor && body && typeof gsap !== 'undefined') {
            let mouseX = 0, mouseY = 0, cursorX = 0, cursorY = 0;
            const speed = 0.1;
            const updateCursorPosition = () => {
                cursorX += (mouseX - cursorX) * speed;
                cursorY += (mouseY - cursorY) * speed;
                cursor.style.left = `${cursorX}px`;
                cursor.style.top = `${cursorY}px`;
                requestAnimationFrame(updateCursorPosition);
            };
            requestAnimationFrame(updateCursorPosition);
            window.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; });
            document.addEventListener('mouseleave', () => cursor.style.opacity = '0');
            document.addEventListener('mouseenter', () => cursor.style.opacity = '1');
            document.querySelectorAll('a, button, input, label[for], .kyc-placeholder-clickable').forEach(el => {
                el.addEventListener('mouseenter', () => gsap.to(cursor, { duration: 0.3, scale: 1.5 }));
                el.addEventListener('mouseleave', () => gsap.to(cursor, { duration: 0.3, scale: 1 }));
            });
        }

        // === LOGIKA ZA ANIMACIJU POZADINE (CANVAS) ===
            if (canvas) {
                const ctx = canvas.getContext('2d');
                let particles = [];
                let mouse = { x: null, y: null };
                const darkOptions = { particleColorRGB: '128, 255, 0', lineColorRGB: '170, 0, 255', particleAmount: 120, defaultRadius: 1.3, linkRadius: 150, particleSpeed: 0.25, lineWidth: 0.4, mouseInteractionRadius: 150, mouseEffectStrength: 2, };
                const lightOptions = { particleColorRGB: '106, 27, 154', lineColorRGB: '171, 71, 188', particleAmount: 120, defaultRadius: 1.3, linkRadius: 150, particleSpeed: 0.25, lineWidth: 0.4, mouseInteractionRadius: 150, mouseEffectStrength: 2, };
                let currentOptions = document.documentElement.classList.contains('light-mode') ? lightOptions : darkOptions;
                const resizeCanvas = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; };
                window.addEventListener('resize', resizeCanvas);
                resizeCanvas();
                window.addEventListener('mousemove', (e) => { mouse.x = e.clientX; mouse.y = e.clientY; });
                window.addEventListener('mouseout', () => { mouse.x = null; mouse.y = null; });
                class Particle {
                    constructor() { this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.z = Math.random() * 2 - 1; this.radius = currentOptions.defaultRadius * (1 + this.z * 0.5); this.vx = (Math.random() - 0.5) * currentOptions.particleSpeed; this.vy = (Math.random() - 0.5) * currentOptions.particleSpeed; }
                    draw() { let finalRadius = this.radius; let opacity = 1; if (mouse.x !== null) { const dist = Math.sqrt(Math.pow(this.x - mouse.x, 2) + Math.pow(this.y - mouse.y, 2)); if (dist < currentOptions.mouseInteractionRadius) { const effect = (1 - dist / currentOptions.mouseInteractionRadius); finalRadius += effect * currentOptions.mouseEffectStrength; opacity += effect * 0.5; } } ctx.beginPath(); ctx.arc(this.x, this.y, finalRadius, 0, Math.PI * 2); ctx.fillStyle = `rgba(${currentOptions.particleColorRGB}, ${opacity * 0.85})`; ctx.fill(); }
                    update() { this.x += this.vx * (1 + this.z * 0.5); this.y += this.vy * (1 + this.z * 0.5); if (this.x > canvas.width + 5) this.x = -5; else if (this.x < -5) this.x = canvas.width + 5; if (this.y > canvas.height + 5) this.y = -5; else if (this.y < -5) this.y = canvas.height + 5; }
                }
                const initParticles = () => { particles = []; for (let i = 0; i < currentOptions.particleAmount; i++) { particles.push(new Particle()); } };
                const drawLines = () => { let pulse = Math.sin(Date.now() * 0.001) * 0.2 + 0.8; for (let i = 0; i < particles.length; i++) { for (let j = i + 1; j < particles.length; j++) { const dist = Math.sqrt(Math.pow(particles[i].x - particles[j].x, 2) + Math.pow(particles[i].y - particles[j].y, 2)); if (dist < currentOptions.linkRadius) { let opacity = (1 - (dist / currentOptions.linkRadius)) * pulse; if (mouse.x !== null) { const distToMouse1 = Math.sqrt(Math.pow(particles[i].x - mouse.x, 2) + Math.pow(particles[i].y - mouse.y, 2)); const distToMouse2 = Math.sqrt(Math.pow(particles[j].x - mouse.x, 2) + Math.pow(particles[j].y - mouse.y, 2)); if(distToMouse1 < currentOptions.mouseInteractionRadius || distToMouse2 < currentOptions.mouseInteractionRadius) { opacity = Math.min(1, opacity + 0.5); } } ctx.beginPath(); ctx.moveTo(particles[i].x, particles[i].y); ctx.lineTo(particles[j].x, particles[j].y); ctx.strokeStyle = `rgba(${currentOptions.lineColorRGB}, ${opacity * 0.5})`; ctx.lineWidth = currentOptions.lineWidth; ctx.stroke(); } } } };
                const animate = () => { ctx.clearRect(0, 0, canvas.width, canvas.height); particles.forEach(p => p.update()); drawLines(); particles.forEach(p => p.draw()); requestAnimationFrame(animate); };
                window.setAnimationTheme = (theme) => { currentOptions = theme === 'light' ? lightOptions : darkOptions; initParticles(); };
                initParticles(); animate();
            }

        // === LOGIKA KYC FORME ===
        if (isGuardianKyc) {
            if (businessWrapper) businessWrapper.style.display = 'none';
        } else if (accountType === 'business') {
            if (businessWrapper) {
                businessWrapper.classList.remove('hidden');
                businessWrapper.classList.add('flex');
            }
        }
        
        const stopCameraStream = () => { if (currentStream) { currentStream.getTracks().forEach(track => track.stop()); currentStream = null; } };
        const closeAllPopups = () => { if (popupOverlay) popupOverlay.style.display = 'none'; document.querySelectorAll('.popup-content').forEach(p => p.style.display = 'none'); if (body) body.classList.remove('overflow-hidden'); stopCameraStream(); };
        const displayPreview = (file, placeholderElement) => { if (!file || !placeholderElement) return; const reader = new FileReader(); reader.onload = (e) => { placeholderElement.style.backgroundImage = `url(${e.target.result})`; placeholderElement.classList.add('has-preview'); }; reader.readAsDataURL(file); };
        const triggerFileInput = (inputId, placeholderId) => { const inputElement = document.getElementById(inputId); if (inputElement) { inputElement.dataset.targetPlaceholder = placeholderId; inputElement.click(); } };

        const triggerCamera = async (placeholderId) => {
            if (isCameraOpening) return;
            isCameraOpening = true;

            if (cameraModal) cameraModal.dataset.targetPlaceholder = placeholderId;
            if (cameraPromptText && cameraOverlay && cameraFeedContainer) {
                cameraOverlay.className = 'camera-overlay';
                cameraFeedContainer.classList.remove('is-horizontal');
                if (placeholderId === 'selfie-placeholder') {
                    cameraPromptText.textContent = 'glavu unutar ovala';
                    cameraOverlay.classList.add('camera-overlay-oval');
                } else {
                    cameraPromptText.textContent = 'dokument unutar okvira';
                    cameraOverlay.classList.add('camera-overlay-rectangle-horizontal');
                    cameraFeedContainer.classList.add('is-horizontal');
                }
            }
            try {
                stopCameraStream();
                if (popupOverlay) popupOverlay.style.display = 'flex';
                if (cameraModal) cameraModal.style.display = 'block';
                if (body) body.classList.add('overflow-hidden');
                currentStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' }, audio: false });
                if (cameraFeed) cameraFeed.srcObject = currentStream;
            } catch (err) {
                alert("Nije moguće pristupiti kameri. Provjerite dozvole.\n" + err.message);
                closeAllPopups();
            } finally {
                setTimeout(() => { isCameraOpening = false; }, 300);
            }
        };

        clickablePlaceholders.forEach(placeholder => {
            placeholder.addEventListener('click', async (event) => {
                if (placeholder.classList.contains('has-preview')) { placeholder.style.backgroundImage = ''; placeholder.classList.remove('has-preview'); return; }
                const inputId = placeholder.dataset.input; const placeholderId = placeholder.id;
                const clickedIcon = event.target.closest('i'); const clickedUploadText = event.target.classList.contains('placeholder-upload-text');
                if (clickedIcon) { await triggerCamera(placeholderId); } 
                else if (clickedUploadText) { triggerFileInput(inputId, placeholderId); }
            });
        });
        
        docUploadInput.addEventListener('change', (e) => { const file = e.target.files[0]; const targetId = e.target.dataset.targetPlaceholder; if(file && targetId) displayPreview(file, document.getElementById(targetId)); e.target.value = null; });
        selfieUploadInput.addEventListener('change', (e) => { const file = e.target.files[0]; const targetId = e.target.dataset.targetPlaceholder; if(file && targetId) displayPreview(file, document.getElementById(targetId)); e.target.value = null; });
        
        if(captureBtn) captureBtn.addEventListener('click', () => { 
            if (!currentStream || !cameraFeed || !snapshotCanvas) return; 
            snapshotCanvas.width = cameraFeed.videoWidth; 
            snapshotCanvas.height = cameraFeed.videoHeight; 
            snapshotCanvas.getContext('2d').drawImage(cameraFeed, 0, 0); 
            const dataUrl = snapshotCanvas.toDataURL('image/png'); 
            const targetId = cameraModal.dataset.targetPlaceholder; 
            if(targetId) { 
                const targetEl = document.getElementById(targetId); 
                targetEl.style.backgroundImage = `url(${dataUrl})`; 
                targetEl.classList.add('has-preview'); 
            } 
            closeAllPopups(); 
        });

        document.querySelectorAll('.popup-close').forEach(btn => btn.addEventListener('click', closeAllPopups));
        
        if (kycContinueBtn) {
            kycContinueBtn.addEventListener('click', (e) => {
                e.preventDefault();
                let docUploaded = false, selfieUploaded = false;
                const idCard = document.getElementById('id-card-placeholder'), driverLicense = document.getElementById('driver-license-placeholder'), passport = document.getElementById('passport-placeholder'), selfie = document.getElementById('selfie-placeholder');
                
                if (idCard?.classList.contains('has-preview') || driverLicense?.classList.contains('has-preview') || passport?.classList.contains('has-preview')) {
                    docUploaded = true;
                }
                if (selfie?.classList.contains('has-preview')) {
                    selfieUploaded = true;
                }
                
                if (!docUploaded || !selfieUploaded) {
                    alert("Molimo učitajte jedan identifikacijski dokument i Vašu fotografiju.");
                    return;
                }

                if (isGuardianKyc) {
                    window.location.href = `register.html?kyc_complete=true&guardian=${guardianId}`;
                } else {
                    if (reviewPopup) reviewPopup.style.display = 'flex';
                }
            });
        }

        if (reviewPopupNastaviBtn) {
            reviewPopupNastaviBtn.addEventListener('click', () => {
                window.location.href = 'index.html';
            });
        }
    });
    </script>

</body>
</html>